<VirtualHost *:80>

	ServerName patches.ubuntu.com
	RedirectMatch permanent ^/(.*) https://patches.ubuntu.com/$1

	CustomLog /var/log/apache2/patches.ubuntu.com-access.log combined
	ErrorLog /var/log/apache2/patches.ubuntu.com-error.log
</VirtualHost>

<VirtualHost *:443>

	ServerName patches.ubuntu.com

	# Security headers
	Header always set X-Frame-Options "SAMEORIGIN"
	Header always set X-Content-Type-Options "nosniff"
	Header always set X-XSS-Protection "1; mode=block"
	Header always set Referrer-Policy "strict-origin-when-cross-origin"

#	SSLEngine On
#	SSLCertificateFile	/etc/ssl/certs/patches.ubuntu.com.crt
#	SSLCertificateKeyFile	/etc/ssl/private/patches.ubuntu.com.key
#	SSLCertificateChainFile	/etc/ssl/certs/patches.ubuntu.com_chain.crt

	CustomLog /var/log/apache2/patches.ubuntu.com-access.log combined
	ErrorLog /var/log/apache2/patches.ubuntu.com-error.log

	DocumentRoot	/srv/merges/published/
	RedirectMatch	permanent	^/patches(/|$)	https://people.ubuntu.com/patches/

	<Directory /srv/merges/published>
		Options FollowSymLinks Indexes MultiViews
		AllowOverride FileInfo
		Require all granted
		IndexOptions DescriptionWidth=* NameWidth=*
	</Directory>

	Header set Strict-Transport-Security "max-age=2592000"

</VirtualHost>

